function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},n=e.parcelRequireeb0a;null==n&&((n=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){s[t]=e},e.parcelRequireeb0a=n),n("gC69E").register(JSON.parse('{"4r2Uz":"app.637c27cf.js","1aC9H":"green-tomato.11c22c57.png","dtDON":"red-tomato.0725a987.png","dgI2O":"favicon.24616066.ico","eZa8n":"notification-ping.09726ea8.mp3","pc06U":"app.ff69ec31.js"}'));var o=n("kor14"),a=n("6bnRN");var r=class{reset(){this.todo=[],this.completed=[],this.save()}save(){a.set("TaskList",JSON.stringify({todo:this.todo,completed:this.completed}))}createTask(t,e){const i={name:t,expected:e,actual:0,time:0};this.todo.push(i),this.save()}deleteTask(t){this.todo.splice(t,1),this.save()}updateTask(t,e,i){t>=Object.keys(this.todo).length||(this.todo[t].name=e,this.todo[t].expected=i,this.save())}addPomo(){this.todo[0].actual+=1,this.save()}finishTask(t){t&&this.updateTime();const e=this.todo[0];this.completed.push(e),this.deleteTask(0)}startTask(){this.startTime=Date.now()}updateTime(){const t=(Date.now()-this.startTime)/1e3,e=60*a.get("WorkSessionDuration");this.todo[0].time+=t;const i=this.todo[0].time,s=Math.round(i/e);this.todo[0].actual=s,this.save()}constructor(){const t=JSON.parse(a.get("TaskList"));null==t?this.reset():(this.todo=t.todo,this.completed=t.completed)}};class d extends HTMLElement{connectedCallback(){this.connected=!0}addRow(t,e){this.data.createTask(t,Number(e)),this.insertRow(this.data.todo.length,t,e),this.editableTaskList.updateButtonState()}resetEditingState(){this.editingRow=null,this.editingInputs=null,this.originalValues=null}editRow(t,e){this.editingRow&&this.cancelEdit(),document.querySelector("editable-task-list-input tomato-slider input[type=number]").disabled=!0,this.editingRow=t,this.editingInputs=e,this.originalValues=e.map((t=>t.value)),t.classList.add("edit-mode"),e.forEach((t=>{t.disabled=!1})),e[0].focus(),e[0].setSelectionRange(e[0].value.length,e[0].value.length)}removeRow(t){this.editingRow&&this.cancelEdit(),this.data.deleteTask(Number(t.dataset.id)),t.remove();const e=["task-num-","task-name-","task-pomos-"];Array.from(this.children).forEach(((t,i)=>{t.querySelector("input").value=i+1,t.dataset.id=i;t.querySelectorAll("input").forEach(((t,s)=>{t.id=e[s]+(i+1)}))})),this.editableTaskList.updateButtonState()}saveEdit(){const[t,e]=this.editingInputs.map((t=>t.value));this.data.updateTask(Number(this.editingRow.dataset.id),t,Number(e)),this.originalValues=[t,e],this.cancelEdit()}cancelEdit(){this.editingRow.classList.remove("edit-mode"),this.editingInputs.forEach(((t,e)=>{t.disabled=!0,t.value=this.originalValues[e]})),document.querySelector("editable-task-list-input tomato-slider input[type=number]").disabled=!1,this.resetEditingState()}insertRow(...t){const e=this.template.cloneNode(!0);this.appendChild(e);const i=this.lastElementChild,s=i.querySelectorAll("input"),n=Array.from(s).slice(-2),[o,a,r,d]=i.querySelectorAll("button"),[l]=t;i.dataset.id=l-1;const c=["task-num-","task-name-","task-pomos-"];s.forEach(((e,i)=>{e.id=c[i]+t[0],e.value=t[i]})),this.connected&&i.querySelector("tomato-slider").render(),n.forEach((t=>{t.addEventListener("keyup",(t=>{"Enter"!==t.code||r.disabled||this.saveEdit()})),t.addEventListener("input",(()=>{const[t,e]=n;0===t.value.length||Number(e.value)<1?r.disabled=!0:r.disabled=!1}))})),o.addEventListener("click",(()=>{r.disabled=!1,this.editRow(i,n)})),a.addEventListener("click",(()=>{this.removeRow(i)})),r.addEventListener("click",(()=>{this.saveEdit()})),d.addEventListener("click",(()=>{this.cancelEdit()}))}constructor(t){super(),this.editableTaskList=t,this.template=document.querySelector("#task-row-template").content,this.data=new r,this.resetEditingState(),this.data.todo.forEach((({name:t,expected:e},i)=>{this.insertRow(i+1,t,e)})),this.connected=!1}}customElements.define("editable-task-list-body",d);var l=d;class c extends HTMLElement{connectedCallback(){this.reset()}updateButtonState(){0===this.nameInput.value.length?this.button.disabled=!0:this.button.disabled=!1}addRow(){this.previousElementSibling.addRow(this.nameInput.value,this.expectedInput.value),this.reset()}reset(){this.nameInput.value="",this.expectedInput.value="1",this.nameInput.focus(),this.updateButtonState(),this.resetCount>0&&this.querySelector("tomato-slider").render(),this.resetCount+=1}constructor(){super();const t=document.querySelector("#add-row-template").content.cloneNode(!0);this.appendChild(t),[this.nameInput,this.expectedInput]=this.querySelectorAll("input"),this.button=this.querySelector("button"),[this.nameInput,this.expectedInput].forEach((t=>{t.addEventListener("input",(()=>{this.updateButtonState()}))})),[this.nameInput,this.expectedInput].forEach((t=>{t.addEventListener("keyup",(t=>{"Enter"!==t.code||this.button.disabled||this.addRow()}))})),this.button.addEventListener("click",(()=>{this.addRow()})),this.resetCount=0}}customElements.define("editable-task-list-input",c);var h=c;class u extends HTMLElement{connectedCallback(){this.updateButtonState()}updateButtonState(){this.querySelectorAll(".start-day-button").forEach((t=>{t.disabled=!(this.body.data.todo.length>0)}))}constructor(){super(),this.appendChild(document.querySelector("#edit-title-template").content.cloneNode(!0));const t=document.createElement("div");t.classList.add("task-list-container"),this.appendChild(t),t.appendChild(document.querySelector("#edit-header-row-template").content.cloneNode(!0)),this.body=new l(this),t.appendChild(this.body),t.appendChild(new h)}}customElements.define("editable-task-list",u);var m=u;class p extends HTMLElement{insertTitle(t){const e=document.createElement("h3");e.classList.add("fw-bold","mb-0","ms-2"),e.textContent=t,this.appendChild(e)}insertHeaderRow(){this.appendChild(this.headerRowTemplate.cloneNode(!0))}insertRow(...t){const e=this.rowTemplate.cloneNode(!0);this.appendChild(e);const i=this.lastElementChild.querySelectorAll("span"),s=["task-num-","task-name-","task-expected-","task-actual-"],n="Completed"===t[4]?"completed-":"todo-";i.forEach(((e,i)=>{e.id=n+s[i]+t[0],e.textContent=t[i]}))}constructor(t,e){super(),this.headerRowTemplate=document.querySelector("#view-header-row-template").content,this.rowTemplate=document.querySelector("#view-row-template").content,this.insertTitle(t),this.insertHeaderRow(),e.forEach((({name:e,expected:i,actual:s},n)=>{this.insertRow(n+1,e,i,s,t)}))}}customElements.define("view-only-task-list-section",p);var g=p;class f extends HTMLElement{connectedCallback(){this.position()}render(){for(;this.taskListContainer.firstChild;)this.taskListContainer.removeChild(this.taskListContainer.firstChild);this.taskListContainer.appendChild(new g("To Do",this.data.todo)),this.data.completed.length>0&&this.taskListContainer.appendChild(new g("Completed",this.data.completed))}position(){this.visible?(this.taskListTitle.innerHTML='<i class="fas fa-chevron-down"></i>',this.style.top=`${this.appHeader.offsetHeight}px`):(this.taskListTitle.innerHTML='<i class="fas fa-chevron-up"></i>',this.style.top=this.appContainer.offsetHeight-(this.querySelector(".task-list-container").getBoundingClientRect().top-this.getBoundingClientRect().top)+"px")}addPomo(){this.data.addPomo(),this.render()}finishTask(t){this.data.finishTask(t),this.render()}startTask(){this.data.startTask()}updateTime(){this.data.updateTime(),this.render()}constructor(){super(),this.data=new r,this.appContainer=document.querySelector(".app-container"),this.appHeader=document.querySelector(".app-header-container"),this.visible=!1,this.taskListTitle=document.createElement("h2"),this.taskListTitle.classList.add("subtitle","text-center","mt-2","mb-2"),this.taskListContainer=document.createElement("div"),this.taskListContainer.classList.add("task-list-container"),this.appendChild(this.taskListTitle),this.appendChild(this.taskListContainer),this.taskListTitle.addEventListener("click",(()=>{this.visible=!this.visible,this.position()})),window.addEventListener("resize",(()=>{this.position()})),this.render()}}customElements.define("view-only-task-list",f);var k=f;var v=class{startTimer(){return new Promise((t=>{const e="Timer Finished";0===this.seconds&&0===this.minutes&&t(e);const i=Math.floor(Date.now()/1e3)+60*this.minutes+(this.seconds-1);this.timer(i);const s=setInterval((()=>{0===this.seconds&&0===this.minutes&&(t(e),clearInterval(s)),this.timer(i)}),1e3)}))}timer(t){let e=t-Math.floor(Date.now()/1e3);e<=0&&(e=0),this.minutes=Math.floor(e/60),this.seconds=e%60,null!==this.callbackEverySecond&&this.callbackEverySecond(this.minutes,this.seconds)}constructor(t,e,i){t>99&&(t=99),this.minutes=t,e>59&&(e=59),this.seconds=e,this.callbackEverySecond=i}},b=n("7BPx9");a=n("6bnRN");class T extends HTMLElement{reset(){this.text="START",this.getAttribute("icon-text")&&(this.setAttribute("icon-text","START"),this.classList.remove("timer-active"))}createTimer(t,e){const i=new Event("timerTick");this.timer=new v(t,e,((t,e)=>{const s=T.parseMinutes(t),n=T.parseSeconds(e);this.svgText.textContent=`${s} : ${n}`,i.text=`${s}:${n}`,document.dispatchEvent(i)}))}startTimer(){return this.text=`${T.parseMinutes(this.timer.minutes)} : ${T.parseSeconds(this.timer.seconds)}`,this.classList.add("timer-active"),this.timer.startTimer()}static parseMinutes(t){return t<10?`0${String(t)}`:String(t)}static parseSeconds(t){return 60===t||t>=60?"00":t<10?`0${String(t)}`:String(t)}setPomoIcon(){this.querySelector("#timerIcon").setAttribute("data",b.default[this.theme].urls[1])}setBreakIcon(){this.querySelector("#timerIcon").setAttribute("data",b.default[this.theme].urls[2])}render(){const t=this.querySelector("#timerIcon");t.addEventListener("load",(()=>{let e=t.contentDocument;e.querySelector("svg").classList.value="w-100 h-100 position-absolute top-50 start-50 translate-middle",this.icon=e.querySelector("svg > g"),this.icon.classList.value="timer-image",this.icon.addEventListener("click",(()=>{this.dispatchEvent(new CustomEvent("iconclick"),{bubbles:!0})})),this.svgText=e.querySelector(".timer-text"),this.svgText.textContent=this.text}))}connectedCallback(){this.render()}attributeChangedCallback(){this.svgText.textContent=this.text}static get observedAttributes(){return["icon-text"]}constructor(){super(),this.theme=a.get("Icon"),this.classList.add("w-100","h-100","d-flex","flex-column","align-items-center"),this.innerHTML=`\n      <div class="timer-container position-relative mh-100 mw-100">\n        <object id="timerIcon" class="w-100 h-100 position-absolute top-50 start-50 translate-middle" data=${b.default[this.theme].urls[1]}></object>\n      </div>\n    `,this.text="START"}}customElements.define("pomo-timer",T);var S=T;a=n("6bnRN"),b=n("7BPx9");class E extends HTMLElement{resetPomos(){this.querySelector(".icon-container").innerHTML=""}setPomos(t){this.resetPomos();const e=document.createElement("template");e.innerHTML='\n      <object class="remaining-pomos-icon" type="image/svg+xml" data=""></object>\n    ';const i=t.todo[0].expected;for(let t=0;t<i;t++)this.querySelector(".icon-container").appendChild(e.content.cloneNode(!0));this.querySelectorAll(".remaining-pomos-icon").forEach((t=>{t.setAttribute("data",this.svgUrls[1])}))}visibleMode(){this.querySelector(".remaining-pomos-container").classList.remove("invisible")}hiddenMode(){this.querySelector(".remaining-pomos-container").classList.add("invisible")}updateCompletedPomos(t){const e=t.todo[0].actual;this.querySelectorAll(".remaining-pomos-icon").forEach(((t,i)=>{i<e&&t.classList.add("completed")}))}constructor(){if(super(),this.taskList=JSON.parse(a.get("TaskList")),this.currentTask=null,!this.taskList||0===this.taskList.todo.length)return;this.svgUrls=b.default[a.get("Icon")].urls;const t=document.createElement("template");t.innerHTML='\n      <div class="remaining-pomos-container">\n        <h3>Planned Pomos</h3>\n        <div class="d-flex justify-content-center align-items-center icon-container"></div>\n      </div>\n    ',this.appendChild(t.content.cloneNode(!0)),this.setPomos(this.taskList),this.updateCompletedPomos(this.taskList)}}customElements.define("remaining-pomos",E);var L=E;o=n("kor14"),a=n("6bnRN");class w extends HTMLElement{getChecked(){return this.checked}updateButton(){this.checked=!1,this.taskList=JSON.parse(a.get("TaskList")),null!=this.taskList&&(this.length=this.taskList.todo.length,this.button.textContent=this.taskList&&this.length>1?"Finish Task":"Finish Final Task")}constructor(t){super(),this.button=document.createElement("button"),this.button.classList.add("btn","btn-success","btn-lg"),this.updateButton(),this.button.addEventListener("click",(()=>{let e={};e=this.length>1?{title:"Move on to next task?",subtitle:" ",leftButton:"Yes",rightButton:"No"}:{title:"End session?",subtitle:" ",leftButton:"Yes",rightButton:"No"},o.default.prompt(e,!0).then((e=>{"left"===e?(this.checked=!0,t.bind(this,this)(),o.default.hide()):"right"===e&&o.default.hide()}))})),this.appendChild(this.button)}}customElements.define("finish-task-button",w);var C,y=w,x=n("lKB7Z");a=n("6bnRN");C=new URL(n("gC69E").resolve("1aC9H"),import.meta.url).toString();var N;N=new URL(n("gC69E").resolve("dtDON"),import.meta.url).toString();var R;R=new URL(n("gC69E").resolve("dgI2O"),import.meta.url).toString();const q=new URL(R);var H;H=new URL(n("gC69E").resolve("eZa8n"),import.meta.url).toString();const I=new URL(H),M=document.querySelector(".app-container"),P=document.querySelector("link[rel*='icon']"),A=document.querySelector("menu-icons");let B=!1,$=null,D=null,O=null,F="Electric Pomato";function _(){const t=Number(a.get("CurrentPomos"));return t>0&&t%4==0}function U(t){document.title=`${t.text} - ${F}`}function J(){let t=JSON.parse(a.get("History"));const{completed:e}=JSON.parse(a.get("TaskList")),i=new Date,s={date:`${i.getMonth()+1}/${i.getDate()}/${i.getFullYear()}`,tasklist:e};t?t.sessions.push(s):t={sessions:[s]},a.set("History",JSON.stringify(t)),a.clearSessionData();const n=document.querySelector("stats-modal");x.default.hasEnoughSessions()?n.open("./index.html"):window.location.href="./index.html"}function j(t){const e=JSON.parse(a.get("TaskList")),{length:i}=e.todo,s=document.querySelector(".app-title"),n=document.querySelector(".app-subtitle");let o="";"true"!==a.get("Timer")||t?_()?s.textContent="Long Break":s.textContent="Short Break":s.textContent="Pomodoro",0===i?(o="End of Session",B=!0,J()):"true"===a.get("Timer")?t?s.textContent=`Focus: ${e.todo[0].name}`:o=`Focus: ${e.todo[0].name}`:o=t&&i>1?`Next Task: ${e.todo[0].name}`:1===i?`Final Task: ${e.todo[0].name}`:`Current Task: ${e.todo[0].name}`,n.textContent=o}function W(t){const e=document.querySelector("#timerIcon").contentDocument;O.finishTask("true"===a.get("Timer")&&"START"!==e.querySelector(".timer-text").textContent),O.data.todo.length>0&&D.setPomos(O.data),j(t.getChecked()),t.updateButton(),O.startTask()}function V(t){if(0===JSON.parse(a.get("TaskList")).todo.length)J();else{const e=a.get("Timer");t.reset(),"true"===e?(j(!1),t.setPomoIcon()):(A.defaultMode(),document.querySelector(".app-subtitle").style.display="block",j(!1),t.setBreakIcon())}}function Y(){const e=a.get("Timer"),i={icon:null,body:null,tag:"pomo-alert",silent:!0};"true"===e?(i.icon=t(C),i.body="Good Work! Time to recharge."):(i.icon=t(N),i.body="Break time is over. It's time to plug in!");let s=null;navigator.serviceWorker.getRegistration().then((t=>{s=t,t.showNotification("Electric Pomato",i).then((()=>s.getNotifications().then((t=>{setTimeout((()=>t.forEach((t=>t.close()))),5e3)})))),new Audio(I).play()}))}function Z(){$=new S,O=new k,D=new L,$.appendChild(D),function(e,i){let s=!1;e.addEventListener("iconclick",(()=>{if(!s){if(document.addEventListener("timerTick",U),"true"===a.get("Timer")){P.href=t(C),F="Plugged in!",A.focusMode(),i.startTask();const s=document.querySelector(".app-title"),n=document.querySelector(".app-subtitle");s.textContent=n.textContent,n.style.display="none";const o=a.get("WorkSessionDuration");e.createTimer(o,0)}else if(P.href=t(N),F="Recharging...",_()){const t=a.get("LongBreakDuration");e.createTimer(t,0)}else{const t=a.get("ShortBreakDuration");e.createTimer(t,0)}D.hiddenMode();const n=new y(W);D.insertAdjacentElement("beforebegin",n),s=!0,e.startTimer().then((()=>{if(!B){document.removeEventListener("timerTick",U),P.href=q,F="Electric Pomato",document.title=F;const t=a.get("Timer");if("true"===t){a.set("TotalPomos",Number(a.get("TotalPomos"))+1),a.set("CurrentPomos",Number(a.get("CurrentPomos"))+1),i.updateTime(),D.updateCompletedPomos(i.data);const t={title:"You have completed the planned Pomodoros for this task. Finish task or continue working?",leftButton:"Finish Task",rightButton:"Continue Working"};i.data.todo[0].actual===i.data.todo[0].expected&&o.default.prompt(t,!1).then((t=>{"left"===t?(n.checked=!0,W(n),o.default.hide()):o.default.hide()}))}e.querySelector("finish-task-button").remove(),"Notification"in window&&navigator.serviceWorker&&"granted"===Notification.permission&&Y(),a.set("Timer","false"===t),D.visibleMode(),V(e),s=!1}}))}}))}($,O),V($),M.appendChild($),M.appendChild(O)}window.addEventListener("load",(function(){null==a.get("Username")?window.location.href="index.html":"true"===a.get("Started")?Z():(null===a.get("HasSeenInfo")&&(A.infoModal.open(),a.set("HasSeenInfo","true")),M.appendChild(new m),document.querySelector(".app-title").textContent=`${a.get("Username")}'s Session`,M.querySelectorAll(".start-day-button").forEach((t=>{t.addEventListener("click",(()=>{a.set("Started",!0),a.set("Timer",!0),a.set("TotalPomos",0),a.set("CurrentPomos",0),M.lastElementChild.remove(),Z()}))}))),"Notification"in window?"granted"===Notification.permission?console.log(`Notifications permission ${Notification.permission}`):"denied"!==Notification.permission?Notification.requestPermission((t=>{"permission"in Notification||(Notification.permission=t),"granted"===t&&console.log("Notifications permission granted")})):console.log(`Notifications permission ${Notification.permission}`):console.log("Error: Browser does not support notifications")}));